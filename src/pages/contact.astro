---
import Base from '../layouts/Base.astro';
import Link from "../components/Link.astro";

const title = "Contact | Ethan Perry";
const description = "Get in touch for collaborations, project inquiries, or general questions and comments.";
---

<Base title={title} description={description}>
    <section class="dual-column with-border-top">
        <h1>Contact</h1>

        <div class="contact">
            <ul class="flex-col-1">
                <li><Link href="mailto:ethan.perry.a@gmail.com" icon={{name: "arrow-right", side: "right"}}>ethan.perry.a@gmail.com</Link></li>
                <li><Link href="https://linkedin.com/in/perry-ethan" target="_blank" rel="noopener noreferrer" icon={{name: "arrow-right", side: "right"}}>LinkedIn</Link></li>
                <li><Link href="https://github.com/perry-ethan" target="_blank" rel="noopener noreferrer" icon={{name: "arrow-right", side: "right"}}>Github</Link></li>
                <li><Link href="https://goodreads.com/ethanperry" target="_blank" rel="noopener noreferrer" icon={{name: "arrow-right", side: "right"}}>Goodreads</Link></li>
            </ul>

            <div class="flex-col-2 form--wrapper margin-top-8 color-text-65">
                <h2>Send me a message</h2>
                <form id="contact-form">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" name="phone">
                    </div>
                    <div class="form-group grid-span">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" required />
                    </div>

                    <div class="form-group grid-span">
                        <button>Submit</button>
                    </div>

                    <div class="honeypot">
                        <label for="honeypot"></label>
                        <textarea id="honeypot" name="honeypot"></textarea>
                    </div>
                </form>

                <div id="form-status" class="hidden">Sending...</div>
            </div>
        </div>
    </section>
</Base>

<script is:inline>
    const form = document.getElementById('contact-form');
    const status = document.getElementById('form-status');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        status.classList.remove('hidden');

        const formData = new FormData(form);

        try {
            const res = await fetch('/api/submit', {
                method: 'POST',
                body: formData
            });

            if (res.ok) {
                status.textContent = "Thank you! Your message has been received. We'll get back to you soon.";
                status.classList.add('color-success')
                form.reset(); // optional: clear the form
            } else {
                status.classList.add('color-failure')
                status.textContent = 'Apologies, something went wrong. Please send me a message directly or try again later.';
            }
        } catch (err) {
            status.classList.add('color-failure')
            status.textContent = 'Error submitting the form. Please check your connection.';
        }
    });
</script>